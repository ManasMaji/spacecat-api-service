site-opportunities:
  parameters:
    - $ref: './parameters.yaml#/siteId'
  get:
    summary: Retrieve a list of all opportunities for a specific site
    tags:
      - opportunities
    responses:
      '200':
        description: A list of opportunities
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/OpportunityList'
    security:
      - api_key: [ ]
  post:
    summary: Create a new opportunity for a specific site
    tags:
      - opportunities
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: './schemas.yaml#/OpportunityCreate'
    responses:
      '201':
        description: Opportunity created
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/Opportunity'
    security:
      - api_key: [ ]

site-opportunities-by-status:
  parameters:
    - $ref: './parameters.yaml#/siteId'
    - name: status
      in: path
      required: true
      schema:
        type: string
  get:
    summary: Retrieve opportunities for a specific site filtered by status
    tags:
      - opportunities
    responses:
      '200':
        description: A list of opportunities filtered by status
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/OpportunityList'
    security:
      - api_key: [ ]

site-opportunity:
  parameters:
    - $ref: './parameters.yaml#/siteId'
    - $ref: './parameters.yaml#/opportunityId'
  get:
    summary: Retrieve details of a specific opportunity
    tags:
      - opportunities
    responses:
      '200':
        description: Details of the opportunity
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/Opportunity'
    security:
      - api_key: [ ]

  patch:
    summary: Update specific attributes of an existing opportunity
    tags:
      - opportunities
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: './schemas.yaml#/OpportunityUpdate'
    responses:
      '200':
        description: Opportunity updated
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/Opportunity'
    security:
      - api_key: [ ]

  delete:
    summary: Delete an opportunity and associated suggestions + fixes
    tags:
      - opportunities
    responses:
      '204':
        description: Opportunity deleted
    security:
      - api_key: [ ]

site-opportunity-suggestions:
  parameters:
    - $ref: './parameters.yaml#/siteId'
    - $ref: './parameters.yaml#/opportunityId'
  get:
    summary: Retrieve a list of all suggestions for a specific opportunity
    tags:
      - opportunity-suggestions
    responses:
      '200':
        description: A list of suggestions
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/SuggestionList'
    security:
      - api_key: [ ]

  post:
    summary: Create and add a list of one or more suggestions to an opportunity in one transaction
    tags:
      - opportunity-suggestions
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: './schemas.yaml#/SuggestionCreateList'
    responses:
      '201':
        description: A list of suggestions created and added to the opportunity
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/SuggestionList'
    security:
      - api_key: [ ]

site-opportunity-suggestions-by-status:
  parameters:
    - $ref: './parameters.yaml#/siteId'
    - $ref: './parameters.yaml#/opportunityId'
    - name: status
      in: path
      required: true
      schema:
        type: string
  get:
    summary: Retrieve suggestions for a specific opportunity filtered by status
    tags:
      - opportunity-suggestions
    responses:
      '200':
        description: A list of suggestions filtered by status
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/SuggestionList'
    security:
      - api_key: [ ]

site-opportunity-suggestions-status:
  parameters:
    - $ref: './parameters.yaml#/siteId'
    - $ref: './parameters.yaml#/opportunityId'
  patch:
    summary: Update the status of one or multiple suggestions in one transaction
    tags:
      - opportunity-suggestions
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: './schemas.yaml#/SuggestionStatusUpdate'
    responses:
      '200':
        description: Suggestions updated
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/SuggestionList'
    security:
      - api_key: [ ]

site-opportunity-suggestion:
  parameters:
    - $ref: './parameters.yaml#/siteId'
    - $ref: './parameters.yaml#/opportunityId'
    - $ref: './parameters.yaml#/suggestionId'
  get:
    summary: Retrieve details of a specific suggestion
    tags:
      - opportunity-suggestions
    responses:
      '200':
        description: Details of the suggestion
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/Suggestion'
    security:
      - api_key: [ ]

  patch:
    summary: Update specific attributes of an existing suggestion
    tags:
      - opportunity-suggestions
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: './schemas.yaml#/SuggestionUpdate'
    responses:
      '200':
        description: Suggestion updated
        content:
          application/json:
            schema:
              $ref: './schemas.yaml#/Suggestion'
    security:
      - api_key: [ ]
