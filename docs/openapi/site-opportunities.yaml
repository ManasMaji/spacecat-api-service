site-opportunities:
  parameters:
    - $ref: './parameters.yaml#/siteId'
  get:
    summary: Retrieve a list of all opportunities for a specific site
    responses:
      '200':
        description: A list of opportunities
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/Opportunity'
  post:
    summary: Create a new opportunity for a specific site
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/OpportunityCreate'
    responses:
      '201':
        description: Opportunity created
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Opportunity'

site-opportunities-by-status:
  parameters:
    - $ref: './parameters.yaml#/siteId'
    - name: status
      in: path
      required: true
      schema:
        type: string
  get:
    summary: Retrieve opportunities for a specific site filtered by status
    responses:
      '200':
        description: A list of opportunities filtered by status
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/Opportunity'

site-opportunity:
  parameters:
    - $ref: './parameters.yaml#/siteId'
    - $ref: './parameters.yaml#/opportunityId'
  get:
    summary: Retrieve details of a specific opportunity
    responses:
      '200':
        description: Details of the opportunity
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Opportunity'
  patch:
    summary: Update specific attributes of an existing opportunity
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/OpportunityUpdate'
    responses:
      '200':
        description: Opportunity updated
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Opportunity'
  delete:
    summary: Delete an opportunity and associated suggestions + fixes
    responses:
      '204':
        description: Opportunity deleted

site-opportunity-suggestions:
  parameters:
    - $ref: './parameters.yaml#/siteId'
    - $ref: './parameters.yaml#/opportunityId'
  get:
    summary: Retrieve a list of all suggestions for a specific opportunity
    responses:
      '200':
        description: A list of suggestions
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/Suggestion'
  post:
    summary: Create a new suggestion for a specific opportunity
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/SuggestionCreate'
    responses:
      '201':
        description: Suggestion created
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Suggestion'

site-opportunity-suggestions-by-status:
  parameters:
    - $ref: './parameters.yaml#/siteId'
    - $ref: './parameters.yaml#/opportunityId'
    - name: status
      in: path
      required: true
      schema:
        type: string
  get:
    summary: Retrieve suggestions for a specific opportunity filtered by status
    responses:
      '200':
        description: A list of suggestions filtered by status
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/Suggestion'

site-opportunity-suggestions-status:
  parameters:
    - $ref: './parameters.yaml#/siteId'
    - $ref: './parameters.yaml#/opportunityId'
  patch:
    summary: Update the status of one or multiple suggestions in one transaction
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/SuggestionStatusUpdate'
    responses:
      '200':
        description: Suggestions updated
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: '#/components/schemas/Suggestion'

site-opportunity-suggestion:
  parameters:
    - $ref: './parameters.yaml#/siteId'
    - $ref: './parameters.yaml#/opportunityId'
    - $ref: './parameters.yaml#/suggestionId'
  get:
    summary: Retrieve details of a specific suggestion
    responses:
      '200':
        description: Details of the suggestion
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Suggestion'
  patch:
    summary: Update specific attributes of an existing suggestion
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/SuggestionUpdate'
    responses:
      '200':
        description: Suggestion updated
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Suggestion'
